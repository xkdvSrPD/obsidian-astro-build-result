import{m as ie}from"./Swup.DhuoVEBe.js";import{e as ue}from"./index.modern.BC8Oj8jT.js";var $=11;function se(e,r){var t=r.attributes,n,a,l,c,p;if(!(r.nodeType===$||e.nodeType===$)){for(var A=t.length-1;A>=0;A--)n=t[A],a=n.name,l=n.namespaceURI,c=n.value,l?(a=n.localName||a,p=e.getAttributeNS(l,a),p!==c&&(n.prefix==="xmlns"&&(a=n.name),e.setAttributeNS(l,a,c))):(p=e.getAttribute(a),p!==c&&e.setAttribute(a,c));for(var b=e.attributes,w=b.length-1;w>=0;w--)n=b[w],a=n.name,l=n.namespaceURI,l?(a=n.localName||a,r.hasAttributeNS(l,a)||e.removeAttributeNS(l,a)):r.hasAttribute(a)||e.removeAttribute(a)}}var V,le="http://www.w3.org/1999/xhtml",o=typeof document>"u"?void 0:document,fe=!!o&&"content"in o.createElement("template"),ce=!!o&&o.createRange&&"createContextualFragment"in o.createRange();function de(e){var r=o.createElement("template");return r.innerHTML=e,r.content.childNodes[0]}function ve(e){V||(V=o.createRange(),V.selectNode(o.body));var r=V.createContextualFragment(e);return r.childNodes[0]}function oe(e){var r=o.createElement("body");return r.innerHTML=e,r.childNodes[0]}function pe(e){return e=e.trim(),fe?de(e):ce?ve(e):oe(e)}function _(e,r){var t=e.nodeName,n=r.nodeName,a,l;return t===n?!0:(a=t.charCodeAt(0),l=n.charCodeAt(0),a<=90&&l>=97?t===n.toUpperCase():l<=90&&a>=97?n===t.toUpperCase():!1)}function he(e,r){return!r||r===le?o.createElement(e):o.createElementNS(r,e)}function ge(e,r){for(var t=e.firstChild;t;){var n=t.nextSibling;r.appendChild(t),t=n}return r}function X(e,r,t){e[t]!==r[t]&&(e[t]=r[t],e[t]?e.setAttribute(t,""):e.removeAttribute(t))}var W={OPTION:function(e,r){var t=e.parentNode;if(t){var n=t.nodeName.toUpperCase();n==="OPTGROUP"&&(t=t.parentNode,n=t&&t.nodeName.toUpperCase()),n==="SELECT"&&!t.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!r.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),t.selectedIndex=-1)}X(e,r,"selected")},INPUT:function(e,r){X(e,r,"checked"),X(e,r,"disabled"),e.value!==r.value&&(e.value=r.value),r.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,r){var t=r.value;e.value!==t&&(e.value=t);var n=e.firstChild;if(n){var a=n.nodeValue;if(a==t||!t&&a==e.placeholder)return;n.nodeValue=t}},SELECT:function(e,r){if(!r.hasAttribute("multiple")){for(var t=-1,n=0,a=e.firstChild,l,c;a;)if(c=a.nodeName&&a.nodeName.toUpperCase(),c==="OPTGROUP")l=a,a=l.firstChild,a||(a=l.nextSibling,l=null);else{if(c==="OPTION"){if(a.hasAttribute("selected")){t=n;break}n++}a=a.nextSibling,!a&&l&&(a=l.nextSibling,l=null)}e.selectedIndex=t}}},O=1,Y=11,J=3,Q=8;function m(){}function Te(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function me(e){return function(t,n,a){if(a||(a={}),typeof n=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var l=n;n=o.createElement("html"),n.innerHTML=l}else n=pe(n);else n.nodeType===Y&&(n=n.firstElementChild);var c=a.getNodeKey||Te,p=a.onBeforeNodeAdded||m,A=a.onNodeAdded||m,b=a.onBeforeElUpdated||m,w=a.onElUpdated||m,Z=a.onBeforeNodeDiscarded||m,C=a.onNodeDiscarded||m,ee=a.onBeforeElChildrenUpdated||m,te=a.skipFromChildren||m,G=a.addChild||function(i,u){return i.appendChild(u)},B=a.childrenOnly===!0,S=Object.create(null),x=[];function U(i){x.push(i)}function K(i,u){if(i.nodeType===O)for(var d=i.firstChild;d;){var s=void 0;u&&(s=c(d))?U(s):(C(d),d.firstChild&&K(d,u)),d=d.nextSibling}}function P(i,u,d){Z(i)!==!1&&(u&&u.removeChild(i),C(i),K(i,d))}function E(i){if(i.nodeType===O||i.nodeType===Y)for(var u=i.firstChild;u;){var d=c(u);d&&(S[d]=u),E(u),u=u.nextSibling}}E(t);function H(i){A(i);for(var u=i.firstChild;u;){var d=u.nextSibling,s=c(u);if(s){var f=S[s];f&&_(u,f)?(u.parentNode.replaceChild(f,u),M(f,u)):H(u)}else H(u);u=d}}function ne(i,u,d){for(;u;){var s=u.nextSibling;(d=c(u))?U(d):P(u,i,!0),u=s}}function M(i,u,d){var s=c(u);if(s&&delete S[s],!d){var f=b(i,u);if(f===!1||(f instanceof HTMLElement&&(i=f,E(i)),e(i,u),w(i),ee(i,u)===!1))return}i.nodeName!=="TEXTAREA"?re(i,u):W.TEXTAREA(i,u)}function re(i,u){var d=te(i,u),s=u.firstChild,f=i.firstChild,N,h,y,R,g;e:for(;s;){for(R=s.nextSibling,N=c(s);!d&&f;){if(y=f.nextSibling,s.isSameNode&&s.isSameNode(f)){s=R,f=y;continue e}h=c(f);var L=f.nodeType,T=void 0;if(L===s.nodeType&&(L===O?(N?N!==h&&((g=S[N])?y===g?T=!1:(i.insertBefore(g,f),h?U(h):P(f,i,!0),f=g,h=c(f)):T=!1):h&&(T=!1),T=T!==!1&&_(f,s),T&&M(f,s)):(L===J||L==Q)&&(T=!0,f.nodeValue!==s.nodeValue&&(f.nodeValue=s.nodeValue))),T){s=R,f=y;continue e}h?U(h):P(f,i,!0),f=y}if(N&&(g=S[N])&&_(g,s))d||G(i,g),M(g,s);else{var F=p(s);F!==!1&&(F&&(s=F),s.actualize&&(s=s.actualize(i.ownerDocument||o)),G(i,s),H(s))}s=R,f=y}ne(i,f,h);var z=W[i.nodeName];z&&z(i,u)}var v=t,D=v.nodeType,j=n.nodeType;if(!B){if(D===O)j===O?_(t,n)||(C(t),v=ge(t,he(n.nodeName,n.namespaceURI))):v=n;else if(D===J||D===Q){if(j===D)return v.nodeValue!==n.nodeValue&&(v.nodeValue=n.nodeValue),v;v=n}}if(v===n)C(t);else{if(n.isSameNode&&n.isSameNode(v))return;if(M(v,n,B),x)for(var I=0,ae=x.length;I<ae;I++){var k=S[x[I]];k&&P(k,k.parentNode,!1)}}return!B&&v!==t&&t.parentNode&&(v.actualize&&(v=v.actualize(t.ownerDocument||o)),t.parentNode.replaceChild(v,t)),v}}var Ae=me(se);function q(){return q=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},q.apply(this,arguments)}const be={INPUT:!0,TEXTAREA:!0,SELECT:!0},Se={INPUT:!0,TEXTAREA:!0,OPTION:!0},Ne={"datetime-local":!0,"select-multiple":!0,"select-one":!0,color:!0,date:!0,datetime:!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,textarea:!0,time:!0,url:!0,week:!0},ye=[function(e,r){return!(!Se[e.tagName]&&e.isEqualNode(r))},function(e,r){const t=e.closest("[data-morph-persist]");if(!t&&be[(n=e).tagName]&&Ne[n.type]&&e===document.activeElement){const a={value:!0};return Array.from(r.attributes).forEach(l=>{a[l.name]||e.setAttribute(l.name,l.value)}),!1}var n;return!t},function(e,r){return e!==document.activeElement||!e.isContentEditable}];function we(e,r,t=[]){const n=[...ye,...t];return Ae(e,r,{onBeforeElUpdated:(a,l)=>function(c,p,A){return!A.map(b=>typeof b!="function"||b(c,p)).includes(!1)}(a,l,n)})}class xe extends ue{constructor(r={}){super(),this.name="SwupMorphPlugin",this.requires={swup:">=4.6"},this.defaults={containers:[],updateCallbacks:[]},this.options=void 0,this.validateContainers=t=>{t.containers=t.containers.filter(n=>!this.options.containers.includes(n))},this.morphContainers=t=>{const n=this.getContainers(document,t.to.document),a=this.options.updateCallbacks||[];for(const{selector:l,outgoing:c,incoming:p}of n)c&&p?we(c,p,a):this.options.containers.includes(l)&&console.warn(`SwupMorphPlugin: No container found for selector: ${l}`)},this.options=q({},this.defaults,r)}mount(){this.before("content:replace",this.validateContainers,{priority:1}),this.on("content:replace",this.morphContainers)}getContainers(r,t){return this.getContainerSelectors().map(n=>({selector:n,outgoing:r.querySelector(n),incoming:t.querySelector(n)}))}getContainerSelectors(){const r=this.options.containers,t=ie('[data-swup-morph]:not([data-swup-morph=""])').map(n=>`[data-swup-morph='${n.dataset.swupMorph}']`);return this.uniq([...r,...t])}uniq(r){return[...new Set(r)]}}export{xe as default};
